# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
  推导过程
在地球-月球系统中，L1拉格朗日点是位于地球和月球连线上的一个平衡点。当一个卫星位于L1点时，它受到的地球引力、月球引力和离心力达到平衡，使得卫星能够相对于地球和月球保持静止。

考虑一个质量为 $m_s$ 的卫星，位于距离地心 $r$ 处，距离月心 $R-r$ 处（ $R$ 为地月距离）。根据牛顿万有引力定律和圆周运动定律，卫星受到的力包括：
地球引力： $F_{earth} = G\frac{M m_s}{r^2}$ ，方向指向地球
月球引力： $F_{moon} = G\frac{m m_s}{(R-r)^2}$ ，方向指向月球
离心力： $F_{centrifugal} = m_s \omega^2 r$ ，方向远离地球
当卫星位于L1点时，这三个力的合力为零。由于地球引力和离心力方向相反，月球引力与地球引力方向相反，因此力平衡方程为：

$$G\frac{M m_s}{r^2} - G\frac{m m_s}{(R-r)^2} = m_s \omega^2 r$$

两边除以 $m_s$ ，得到：

$$G\frac{M}{r^2} - G\frac{m}{(R-r)^2} = \omega^2 r$$

这就是L1点位置方程。
物理意义
这个方程描述了在地球和月球引力场中，一个物体能够保持相对于地球和月球静止的条件。左边第一项是地球引力加速度，第二项是月球引力加速度，右边是离心加速度。当这三个加速度达到平衡时，物体就可以稳定地位于L1点。

- 牛顿法和弦截法的实现策略
 
牛顿法是一种迭代算法，用于求解方程 $f(x) = 0$ 的根。其基本思想是利用函数的导数（切线）来逼近根的位置。迭代公式为：

$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$$

实现步骤：
1. 从初始猜测值 $x_0$ 开始
2. 计算当前点的函数值 $f(x_n)$ 和导数值 $f'(x_n)$ 
3. 根据迭代公式计算下一个点 $x_{n+1}$ 
4. 检查收敛条件（相对误差小于容差）
5. 如果未收敛，则继续迭代，直到达到最大迭代次数或满足收敛条件

弦截法是牛顿法的一种变种，不需要计算导数，而是通过两个点的函数值来估计导数。迭代公式为：

$$x_{n+1} = x_n - f(x_n) \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}$$

实现步骤：
1. 从初始区间 $[a, b]$ 开始
2. 计算区间端点的函数值 $f(a)$ 和 $f(b)$ 
3. 根据迭代公式计算下一个点 $x_{n+1}$ 
4. 更新区间端点，保留最新的两个点
5. 检查收敛条件（相对误差小于容差）
6. 如果未收敛，则继续迭代，直到达到最大迭代次数或满足收敛条件

- 初值或初始区间的选择依据
  对于牛顿法，我们选择初始值 $r_0 = 3.5 \times 10^8$  m，约为地月距离的90%。选择依据如下：
  
  1.L1点位于地球和月球之间，且更靠近月球
  2.通过绘制方程曲线（见`plot_lagrange_equation`函数），可以观察到方程在 $3.0 \times 10^8$ m到$3.8 \times 10^8$  m之间有一个根
  3.初始值选在根附近可以确保牛顿法快速收敛

  对于弦截法，我们选择初始区间$[3.2 \times 10^8, 3.7 \times 10^8]$ m。选择依据如下：
  
  1.区间包含方程的根
  2.区间端点处的函数值异号（虽然弦截法不要求这一点，但可以提高收敛可靠性）
  3.区间大小适中，既不过大导致收敛缓慢，也不过小导致无法包含根

## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

![屏幕截图 2025-05-21 102546](https://github.com/user-attachments/assets/5ed8a920-093c-498e-9139-3988349c9afa)


图像说明：
根据代码中的方程和图像分析，图中的零点位置对应地球-月球系统中L1拉格朗日点的位置。这个点位于地球和月球之间的连线上，约为 $3.26 \times 10^8$ 米（即326,000公里），约为地月距离的 84.8%
物理位置位于地球和月球之间，更靠近月球（因为月球质量远小于地球，引力平衡点偏向月球一侧）。
物理意义：

这个零点代表卫星在该位置所受的合力为零，即地球引力、月球引力、离心力


### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   |        3.26e+08    |          0.8481         |     6    |     是   |
| 弦截法   |        3.26e+08    |              0.8481     |     7    |     是   |
| fsolve  |        3.26e+08    |          0.8481         | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 | 1.94e-02 | 0.00000001% |
| 牛顿法 vs fsolve | 2.378e-05 | 0.00000000001% |
| 弦截法 vs fsolve | 1.937e-02 | 0.00000001% |

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
  L1点位于地球和月球之间的连线上，是一个引力平衡点。在此位置，卫星受到的地球引力、月球引力与离心力达到平衡，合力为零。数学上，这表现为方程 $G\frac{M}{r^2} - G\frac{m}{(R-r)^2} = \omega^2 r$ 的解。由于地球质量远大于月球，L1点更靠近月球（约为地月距离的84.8%）。这种平衡允许卫星无需消耗大量燃料即可保持相对静止，成为天然的“太空停泊站”。
- 在L1点放置卫星有什么实际应用？

1.稳定观测平台：卫星可持续监测地月系统，例如监测月球背面（避免地球遮挡）或太阳活动（如SOHO卫星在日地L1点）。

2. 通信中继：作为地球与月球探测器的通信枢纽，减少信号延迟。
   
3. 深空探测中转站：航天器可在此进行燃料补给或轨道调整，降低任务成本。

### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
  牛顿法，二次收敛，每步迭代误差大致平方减少，对该问题通常3-4次迭代即可收敛。
  弦截法，超线性收敛（约1.618次幂），收敛速度稍慢，通常需要5-7次迭代。

- 对初值/初始区间的敏感性
  牛顿法：依赖导数信息，初值需接近真实解（如代码中选择3.5e8m），否则可能发散。
  弦截法：通过区间两点估计导数，对初值要求较低（如区间[3.2e8, 3.7e8]m），但需确保区间包含根。

- 计算复杂度和实现难度
  复杂度
  牛顿法：每次迭代需计算函数值和导数值，计算量较大。
  弦截法：每次迭代仅需计算函数值，但需保留两个历史点，内存需求略高。

  实现难度
  牛顿法：需显式计算导数（如代码中`lagrange_equation_derivative`），实现稍复杂。
  弦截法：无需导数，直接通过函数值估计切线，实现更简单。

### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

若地球质量$M$增加，地球引力增强，L1点将向月球方向移动。
物理解释：更大的地球引力需要卫星离地球更远（同时离月球更近），才能使月球引力和离心力的合力与地球引力平衡。数学上，方程的解$r$会增大，但由于分母为$R-r$，月球引力的影响范围会缩小，导致平衡点更靠近月球。

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？
   L2点：位于地球外侧的地月连线上，是另一个引力平衡点，适合放置天文望远镜（如詹姆斯·韦伯空间望远镜），避免地球和月球的干扰。
   
   L3点：位于地球对侧的月球轨道上，受太阳引力摄动较大，稳定性较差，暂无实际应用。
   
   L4和L5点：位于月球轨道前方和后方60°处，形成等边三角形，是稳定平衡点，可能存在天然小行星或可用于放置长期观测站。确定这些点需考虑更复杂的引力矢量合成，通常通过数值方法求解非线性方程组。


## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

拉格朗日点的物理意义，引力平衡点，L1 点是地球 - 月球系统中位于两体连线上的引力平衡点，在此处卫星所受地球引力、月球引力与离心力达到平衡（合力为零）。这使得卫星无需持续消耗燃料即可保持相对静止，成为理想的太空观测与通信平台。
拉格朗日点方程是高次非线性方程，无法解析求解。数值方法（如牛顿法、弦截法）提供了高效的迭代求解框架，适用于此类复杂问题。

实验收获：物理与数学的结合，通过推导拉格朗日点方程，深刻理解了引力与离心力平衡的物理原理，并掌握了将物理问题转化为数学模型的方法。
算法设计与实现，对比牛顿法和弦截法的实现，体会到算法选择对计算效率和结果可靠性的影响，增强了数值计算的工程实践能力。
工具链的应用，学会使用 SciPy 库进行方程求解，并通过 Matplotlib 可视化验证结果，掌握了现代科学计算的工具链。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
def lagrange_equation(r):
    """
    L1拉格朗日点位置方程

    参数:
        r (float): 从地心到L1点的距离 (m)

    返回:
        float: 方程左右两边的差值，当r是L1点位置时返回0
    """
    # 地球引力
    f_earth = G * M / r ** 2
    # 月球引力（注意方向）
    f_moon = G * m / (R - r) ** 2
    # 离心力
    f_centrifugal = omega ** 2 * r

    # 力平衡方程
    equation_value = f_earth - f_moon - f_centrifugal
    return equation_value


def lagrange_equation_derivative(r):
    """
    L1拉格朗日点位置方程的导数，用于牛顿法

    参数:
        r (float): 从地心到L1点的距离 (m)

    返回:
        float: 方程对r的导数值
    """
    # 对方程 G*M/r^2 - G*m/(R-r)^2 = ω^2*r 求导
    # 导数为 -2*G*M/r^3 - 2*G*m/(R-r)^3 - ω^2
    derivative_value = -2 * G * M / r ** 3 - 2 * G * m / (R - r) ** 3 - omega ** 2
    return derivative_value


def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    """
    使用牛顿法（切线法）求解方程f(x)=0

    参数:
        f (callable): 目标方程，形式为f(x)=0
        df (callable): 目标方程的导数
        x0 (float): 初始猜测值
        tol (float): 收敛容差
        max_iter (int): 最大迭代次数

    返回:
        tuple: (近似解, 迭代次数, 收敛标志)
    """
    x = x0
    iterations = 0
    converged = False

    for i in range(max_iter):
        fx = f(x)
        dfx = df(x)

        # 检查导数是否接近零
        if abs(dfx) < 1e-12:
            break

        # 牛顿迭代公式
        x_new = x - fx / dfx

        # 检查收敛性
        relative_error = abs((x_new - x) / x_new)
        if relative_error < tol:
            converged = True
            iterations = i + 1
            x = x_new
            break

        x = x_new

    return x, iterations, converged

```


