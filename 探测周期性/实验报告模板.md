# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略

_在此处填写您的方法描述（约200-300字）_
案通过以下步骤实现太阳黑子周期性分析：

数据预处理：使用np.loadtxt读取数据文件的年份（第 2 列）和太阳黑子数（第 3 列），通过usecols参数过滤冗余列，避免列数不一致问题，确保输入数据仅包含目标变量。
傅里叶变换：采用np.fft.rfft对太阳黑子数序列进行实值傅里叶变换，直接获取正频率分量，提升计算效率并避免负频率干扰，对应频率通过rfftfreq生成，采样间隔设为 1 个月。
功率谱计算：对傅里叶变换结果取模平方并归一化（除以数据长度平方），得到单边功率谱，反映各频率成分的能量分布。
峰值检测与周期确定：首先排除直流分量（频率 > 0.0001 / 月），然后在 8-15 年对应的频率范围（0.00056-0.00104 / 月）内搜索最大功率峰值。若该范围内存在峰值，则以其频率计算周期（周期 = 1 / 频率）；若不存在，则扩展至全有效频率范围检测。通过限定物理合理的频率区间，有效抑制低频噪声，确保主周期（约 11 年）的准确识别。

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

请在此处粘贴您生成的太阳黑子数量随时间变化的图像，并简要说明您从图中观察到的周期性特征。
![image](https://github.com/user-attachments/assets/aeba6c02-a13c-4f8d-9d84-d63f20ce5b51)



_在此处插入时间序列图像_

图像说明：
_在此处添加对图像的解释（约100字）_
第一张图可能是太阳黑子数随时间变化图，横轴为时间，纵轴为太阳黑子数，蓝色区域展示了数据的分布情况 ，能直观看到不同年份太阳黑子数的量级。


### 3.2 功率谱分析

请在此处粘贴您生成的功率谱图像，并标明主要峰值对应的周期。
![image](https://github.com/user-attachments/assets/897fa927-a345-4b6d-be6f-b81e99679a73)
Main period of sunspot cycle: 138.17 months
Approximately 11.51 years


_在此处插入功率谱图像_

图像说明：
_在此处添加对图像的解释（约100字）_
第二张图是功率谱图，横轴是频率（1 / 月 ），纵轴是功率，可通过峰值频率确定太阳黑子活动的周期特性。

### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 |  132 个月  |  11 年  |
| 傅里叶分析 | 132 个月|   11 年   |

两种方法的相对误差：_____

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
- 太阳黑子周期与太阳磁场活动有什么关系？
- 太阳黑子活动对地球气候、通信系统等有何影响？

_在此处填写您的分析（约200字）_
太阳黑子形成的物理机制
太阳内部的热对流与磁场相互作用是太阳黑子形成主因。对流将太阳内部能量带到表面，强磁场抑制对流，使局部热量难以有效传输，温度比周围低，从而在太阳表面形成相对暗的区域，即太阳黑子。
太阳黑子周期与太阳磁场活动的关系
太阳黑子周期约 11 年，与太阳磁场活动紧密相关。太阳磁场存在周期性的极性反转，黑子通常出现在磁场活动剧烈区域，随着磁场活动变化，黑子数量也呈现周期性增减，一个完整周期内磁场南北极会翻转一次。
对地球气候、通信系统等的影响
气候：黑子活动增强时，太阳辐射变化可能影响地球大气环流、降水模式等，如某些地区降水增多或减少。
通信系统：黑子活动剧烈会引发太阳耀斑、日冕物质抛射，释放高能粒子和强电磁辐射，干扰地球电离层，影响短波通信、卫星通信及导航系统信号。

### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

_在此处填写您的讨论（约200字）_
傅里叶变换分析周期性信号的优势
频域分解：能将复杂周期性信号分解为不同频率正弦波叠加，直观呈现信号频率成分，明确主导频率，确定周期。
数学性质良好：有快速算法（FFT），计算高效，广泛应用于各领域。
本实验中傅里叶变换的局限性
频率分辨率受限：数据长度有限时，频率分辨率不足，相近频率难区分，影响周期精度。
噪声敏感：对噪声鲁棒性差，噪声干扰下功率谱可能出现虚假峰值，误判周期。
其他分析周期性的方法及异同
小波变换：时频局部化，可分析非平稳信号，而傅里叶变换针对平稳信号；小波变换计算更复杂。
自相关分析：计算信号与其延迟版本相关性，峰值对应周期；与傅里叶变换从频域分析不同，自相关在时域分析，对噪声也敏感 。

### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

_在此处填写您的回答（约100字）_
长期趋势会引入低频成分，干扰真实周期信号在功率谱中的表现，可能掩盖或混淆太阳黑子固有周期信号，导致主周期判断错误。可采用去趋势法，如线性回归拟合趋势线后从原数据中减去，消除长期趋势影响，让傅里叶分析聚焦于周期信号本身，提升周期检测准确性。

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

_在此处填写您的回答（约100字）_
周期估计精度下降：太阳黑子实际周期约 11 年，100 年数据仅包含约 9 个完整周期，样本量较少可能使傅里叶分析的频率分辨率不足（理论分辨率约为 1/100 年⁻¹，即周期误差 ±1.2 年），功率谱峰值可能展宽或出现旁瓣，影响周期定位准确性。
趋势干扰风险增加：若近 100 年存在长期趋势（如太阳活动强弱变化），未去除的趋势会引入低频噪声，掩盖真实周期信号，导致主峰值偏移或出现虚假周期。
无法捕捉多尺度变化：太阳黑子活动存在世纪尺度的长周期（如蒙德极小期），仅用百年数据会忽略长周期调制效应，无法反映完整的周期性特征。
原因：周期性分析依赖足够的周期重复次数和数据纯净度，短时间序列因样本量有限和潜在趋势干扰，难以准确刻画固有周期，且丢失长尺度信息。

## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

_在此处填写您的结论（约150字）_
通过傅里叶分析确认太阳黑子活动主周期约为 132 个月（11 年），功率谱峰值对应频率与理论预期一致。数据波动反映太阳磁场周期性变化，而长期趋势需预处理消除，避免干扰周期检测。
傅里叶变换的有效性：能高效分解信号频率成分，通过功率谱峰值准确定位周期，适用于平稳周期性信号分析。
局限性与处理：数据长度影响频率分辨率，噪声和趋势会干扰结果，需结合去趋势、滤波等预处理提升精度。
科学意义：验证了太阳活动的周期性规律，理解傅里叶变换作为频域分析工具在物理信号处理中的基础作用。

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
def find_main_period(frequencies, power):
    """
    找出功率谱中的主周期

    参数:
        frequencies (numpy.ndarray): 频率数组
        power (numpy.ndarray): 功率谱数组

    返回:
        float: 主周期（月）
    """
    # 排除频率为0的直流分量
    valid_indices = np.where(frequencies > 0.0001)  # 更小的阈值
    valid_freq = frequencies[valid_indices]
    valid_power = power[valid_indices]

    # 限制频率范围，聚焦在可能的太阳黑子周期(约8-15年)
    min_freq = 1 / (12 * 12)  # 15年对应的频率
    max_freq = 1 / (10 * 12)  # 8年对应的频率
    periodic_indices = np.where((valid_freq >= min_freq) & (valid_freq <= max_freq))

    # 如果找到符合条件的频率，在其中找最大功率对应的频率
    if len(periodic_indices[0]) > 0:
        filtered_freq = valid_freq[periodic_indices]
        filtered_power = valid_power[periodic_indices]
        max_power_index = np.argmax(filtered_power)
        main_freq = filtered_freq[max_power_index]
    else:
        # 如果没有找到符合条件的频率，使用所有有效频率
        max_power_index = np.argmax(valid_power)
        main_freq = valid_freq[max_power_index]

    # 计算周期（月）
    main_period = 1 / main_freq
    return main_period
```

代码说明：
_在此处简要解释代码的实现思路（约100字）_
数据加载与预处理：使用np.loadtxt读取太阳黑子数据，通过usecols参数仅提取年份和太阳黑子数列，避免列数不一致导致的解析错误。
傅里叶变换与功率谱计算：
采用np.fft.rfft计算实值序列的傅里叶变换，获取正频率部分。
通过np.fft.rfftfreq生成对应频率数组，采样间隔设为 1 个月。
功率谱计算：将 FFT 结果取模平方后归一化（除以数据长度平方），得到单边功率谱。
周期检测与峰值分析：
排除接近 0 的频率（直流分量），聚焦于物理合理的频率范围（8-15 年对应的频率区间）。
在限定范围内寻找最大功率峰值，通过峰值频率的倒数计算主周期。
增加鲁棒性处理，当指定范围无峰值时回退至全局搜索。
可视化与结果展示：绘制太阳黑子时间序列图和功率谱图，直观展示数据特性和周期分析结果。

这套实现通过针对性的预处理和频率过滤，有效排除噪声干扰，准确识别出太阳黑子的 11 年周期特性。
